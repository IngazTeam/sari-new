# ุฏููู ุชูุงูู Zid ูุน ุณุงุฑู

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ุชูุงูู ูุงูู ูุน ููุตุฉ **Zid** ูุฑุจุท ูุชุฌุฑู ุงูุฅููุชุฑููู ูุน ูุธุงู ุณุงุฑู ูููุจูุนุงุช ุนุจุฑ WhatsApp.

## ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. ุฑุจุท ุงูููุชุฌุงุช ูุน ูุชุงููุฌ ุณุงุฑู โ

**ุงููุตู:** ุฏูุฌ ุงูููุชุฌุงุช ุงููุณุชูุฑุฏุฉ ูู Zid ูุน ูุธุงู ุงูููุชุฌุงุช ุงูุญุงูู ูู ุณุงุฑู ูุนุฑุถูุง ูู ูุญุงุฏุซุงุช WhatsApp.

**ููู ูุนูู:**
- ูุชู ุงุณุชูุฑุงุฏ ุงูููุชุฌุงุช ูู ูุชุฌุฑ Zid ุนุจุฑ API
- ุชูุญูุธ ุงูููุชุฌุงุช ูู ุฌุฏูู `zid_products` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุนูุฏ ุจุญุซ ุงูุนููู ุนู ููุชุฌ ุนุจุฑ WhatsAppุ ูุจุญุซ ุณุงุฑู ูู:
  * ุงูููุชุฌุงุช ุงููุถุงูุฉ ูุฏููุงู ูู ุณุงุฑู
  * ุงูููุชุฌุงุช ุงููุณุชูุฑุฏุฉ ูู Zid
- ูุนุฑุถ ุณุงุฑู ุงูููุชุฌุงุช ูุน ุงูุฃุณุนุงุฑ ูุงูููุงุตูุงุช ุจุดูู ููุญุฏ

**ุงููููุงุช ุงููุชุฃุซุฑุฉ:**
- `server/ai.ts` - ุชุญุฏูุซ ุฏุงูุฉ `searchProducts()` ูุฏูุฌ ููุชุฌุงุช Zid
- `drizzle/schema.ts` - ุฌุฏูู `zid_products`
- `server/db.ts` - ุฏูุงู `getZidProducts()`, `saveZidProduct()`

### 2. ุฅูุดุงุก ุทูุจุงุช ูู Zid ูู WhatsApp โ๏ธ

**ุงูุญุงูุฉ:** ุฌุงูุฒ ููุชุทููุฑ ุงููุณุชูุจูู

**ุงูุชุตููู ุงูููุชุฑุญ:**
1. ุนูุฏูุง ูุคูุฏ ุงูุนููู ุงูุทูุจ ุนุจุฑ WhatsApp
2. ูููู ุณุงุฑู ุจุฅูุดุงุก ุทูุจ ูู ูุชุฌุฑ Zid ุชููุงุฆูุงู ุนุจุฑ API
3. ูุฑุณู ุฑูู ุงูุทูุจ ููุนููู
4. ูุชู ุฑุจุท ุงูุทูุจ ูู ุณุงุฑู ูุน ุงูุทูุจ ูู Zid

**APIs ุงูุฌุงูุฒุฉ:**
- `server/_core/zidApi.ts` - ุฏุงูุฉ `createZidOrder()`
- `server/integrations/zid/zidClient.ts` - ZidClient class

**ูุง ูุญุชุงุฌ ุฅุถุงูุฉ:**
- ุชุญุฏูุซ ููุทู ุชุฃููุฏ ุงูุทูุจ ูู `server/ai.ts`
- ุฅุถุงูุฉ API endpoint: `zid.createOrder`
- ุฑุจุท ุงูุทูุจ ูู ุฌุฏูู `orders` ูุน `zid_orders`

### 3. ุฅุนุฏุงุฏ Webhooks ูู Zid โ

**ุงููุตู:** ุงุณุชูุจุงู ุชุญุฏูุซุงุช ููุฑูุฉ ุนู ุงูุทูุจุงุช ูุงูููุชุฌุงุช ูู Zid.

**ุงูุฃุญุฏุงุซ ุงููุฏุนููุฉ:**

#### ุฃ. ุงูุทูุจุงุช (Orders)
- **order.created** - ุทูุจ ุฌุฏูุฏ
  * ูุญูุธ ุงูุทูุจ ูู `zid_orders`
  * ูุฑุณู ุฅุดุนุงุฑ ููุชุงุฌุฑ ุนุจุฑ WhatsApp
  
- **order.updated** - ุชุญุฏูุซ ุญุงูุฉ ุทูุจ
  * ูุญุฏุซ ุงูุทูุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  * ูุฑุณู ุชุญุฏูุซ ููุนููู ุนุจุฑ WhatsApp
  
- **order.cancelled** - ุฅูุบุงุก ุทูุจ
  * ูุญุฏุซ ุญุงูุฉ ุงูุทูุจ ุฅูู "cancelled"
  * ูุฑุณู ุฅุดุนุงุฑ ุฅูุบุงุก ููุนููู

#### ุจ. ุงูููุชุฌุงุช (Products)
- **product.created** - ููุชุฌ ุฌุฏูุฏ
- **product.updated** - ุชุญุฏูุซ ููุชุฌ
- **product.deleted** - ุญุฐู ููุชุฌ

#### ุฌ. ุงููุฎุฒูู (Inventory)
- **inventory.updated** - ุชุญุฏูุซ ูููุฉ ุงููุฎุฒูู

**ุงููููุงุช:**
- `server/webhooks/zid-webhook.ts` - ูุนุงูุฌ Webhooks ุงููุงูู
- `server/integrations/zid.ts` - API endpoint: `zid.handleWebhook`

**ุฅุนุฏุงุฏ Webhook ูู Zid:**
```
URL: https://your-domain.com/api/trpc/zid.handleWebhook
Method: POST
```

## ุงูุจููุฉ ุงูุชูููุฉ

### ูุงุนุฏุฉ ุงูุจูุงูุงุช

#### ุฌุฏุงูู ุฌุฏูุฏุฉ:

**1. zid_products** - ุงูููุชุฌุงุช ุงููุณุชูุฑุฏุฉ ูู Zid
```sql
- id (PK)
- merchantId
- zidProductId (ูุนุฑู ุงูููุชุฌ ูู Zid)
- zidSku
- nameAr, nameEn
- descriptionAr, descriptionEn
- price, salePrice
- quantity (ุงููุฎุฒูู)
- mainImage, images
- categoryId, categoryName
- isActive, isPublished
- zidData (JSON ูุงูู)
```

**2. zid_orders** - ุงูุทูุจุงุช ุงููุชุฒุงููุฉ ูู Zid
```sql
- id (PK)
- merchantId
- zidOrderId (ูุนุฑู ุงูุทูุจ ูู Zid)
- zidOrderNumber
- customerName, customerEmail, customerPhone
- totalAmount, currency
- status, paymentStatus
- items (JSON)
- shippingAddress (JSON)
- orderDate
- zidData (JSON ูุงูู)
```

**3. zid_webhooks** - ุณุฌู Webhooks
```sql
- id (PK)
- merchantId
- webhookId
- eventType
- payload (JSON)
- status (pending/processed/failed)
- processedAt
```

**4. zidSettings** - ุฅุนุฏุงุฏุงุช ุงูุฑุจุท (ููุฌูุฏ ูุณุจูุงู)
```sql
- merchantId
- clientId, clientSecret
- accessToken, managerToken, refreshToken
- isActive
- lastProductSync, lastOrderSync
```

### Backend APIs

#### Zid Router (`server/integrations/zid.ts`)

**APIs ุงูููุฌูุฏุฉ:**
- `zid.connect` - ุฑุจุท ุญุณุงุจ Zid (OAuth)
- `zid.disconnect` - ูุตู ุงูุงุชุตุงู
- `zid.getStatus` - ุญุงูุฉ ุงูุงุชุตุงู
- `zid.syncProducts` - ูุฒุงููุฉ ุงูููุชุฌุงุช
- `zid.syncOrders` - ูุฒุงููุฉ ุงูุทูุจุงุช
- `zid.syncCustomers` - ูุฒุงููุฉ ุงูุนููุงุก
- `zid.getSyncLogs` - ุณุฌู ุงููุฒุงููุฉ
- `zid.getSyncStats` - ุฅุญุตุงุฆูุงุช ุงููุฒุงููุฉ
- `zid.handleWebhook` - ูุนุงูุฌุฉ Webhook โจ ุฌุฏูุฏ

#### Database Functions (`server/db.ts`)

**ุฏูุงู Zid ุงูุฌุฏูุฏุฉ:**
```typescript
// Products
- getZidProducts(merchantId)
- getZidProductByZidId(merchantId, zidProductId)
- saveZidProduct(merchantId, productData)
- linkZidProductToSariProduct(zidProductId, sariProductId)

// Orders
- getZidOrders(merchantId, filters?)
- getZidOrderByZidId(merchantId, zidOrderId)
- saveZidOrder(merchantId, orderData)

// Webhooks
- saveZidWebhook(merchantId, webhookData)
- updateZidWebhookStatus(webhookId, status, error?)
- getZidWebhooks(merchantId, filters?)
```

### Frontend Pages

**ุงูุตูุญุงุช ุงูููุฌูุฏุฉ:**
- `/merchant/zid/settings` - ZidSettings.tsx - ุฅุนุฏุงุฏุงุช ุงูุฑุจุท
- `/merchant/zid/products` - ZidProducts.tsx - ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช
- `/merchant/zid/sync-logs` - ZidSyncLogs.tsx - ุณุฌู ุงููุฒุงููุฉ
- `/merchant/zid/callback` - ZidCallback.tsx - OAuth callback
- `/merchant/zid` - ZidIntegration.tsx - ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ

## ุฏููู ุงูุงุณุชุฎุฏุงู

### 1. ุฑุจุท ูุชุฌุฑ Zid

1. ุงูุชูู ุฅูู **ุงูุฅุนุฏุงุฏุงุช > ุชูุงูู Zid**
2. ุฃุฏุฎู Client ID ู Client Secret ูู ููุญุฉ ุชุญูู Zid
3. ุงุถุบุท ุนูู "ุฑุจุท Zid"
4. ุณูุชู ุชูุฌููู ูุตูุญุฉ OAuth ููููุงููุฉ
5. ุจุนุฏ ุงูููุงููุฉุ ุณูุชู ุญูุธ Access Token ุชููุงุฆูุงู

### 2. ุงุณุชูุฑุงุฏ ุงูููุชุฌุงุช

**ุทุฑููุฉ 1: ุงููุฒุงููุฉ ุงููุฏููุฉ**
1. ุงูุชูู ุฅูู **Zid > ุงูููุชุฌุงุช**
2. ุงุถุบุท ุนูู "ูุฒุงููุฉ ุงูููุชุฌุงุช"
3. ุณูุชู ุงุณุชูุฑุงุฏ ุฌููุน ุงูููุชุฌุงุช ูู Zid

**ุทุฑููุฉ 2: ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ**
1. ูู **ุงูุฅุนุฏุงุฏุงุช**ุ ูุนูู "ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ ููููุชุฌุงุช"
2. ุณูุชู ุงููุฒุงููุฉ ูู 6 ุณุงุนุงุช ุชููุงุฆูุงู

### 3. ุฅุนุฏุงุฏ Webhooks

1. ุณุฌูู ุงูุฏุฎูู ุฅูู ููุญุฉ ุชุญูู Zid
2. ุงูุชูู ุฅูู **ุงูุฅุนุฏุงุฏุงุช > Webhooks**
3. ุฃุถู Webhook ุฌุฏูุฏ:
   ```
   URL: https://your-domain.manus.space/api/trpc/zid.handleWebhook
   Events: ุงุฎุชุฑ ุงูุฃุญุฏุงุซ ุงููุทููุจุฉ
   ```
4. ุงุญูุธ Webhook Secret ูู ุฅุนุฏุงุฏุงุช ุณุงุฑู

### 4. ุงุณุชุฎุฏุงู ุงูููุชุฌุงุช ูู WhatsApp

**ุชููุงุฆูุงู!** ูุง ุญุงุฌุฉ ูุฃู ุฅุนุฏุงุฏ ุฅุถุงูู.

ุนูุฏูุง ูุณุฃู ุงูุนููู ุนู ููุชุฌ:
```
ุนููู: ุนูุฏูู ุขูููู 15ุ
ุณุงุฑู: ูุนู ุนูุฏูุง ุขูููู 15 ุจุฑู ุจุณุนุฑ 3,999 ุฑูุงู...
```

ุณุงุฑู ุณูุจุญุซ ูู ูู ูู:
- ุงูููุชุฌุงุช ุงููุถุงูุฉ ูุฏููุงู
- ุงูููุชุฌุงุช ุงููุณุชูุฑุฏุฉ ูู Zid

## ุงูุฅุดุนุงุฑุงุช ุงูุชููุงุฆูุฉ

### ุฅุดุนุงุฑุงุช ุงูุชุงุฌุฑ
- ๐ ุทูุจ ุฌุฏูุฏ ูู Zid
- ๐ฆ ุชุญุฏูุซ ุญุงูุฉ ุทูุจ
- โ๏ธ ูุดููุฉ ูู ุงููุฒุงููุฉ

### ุฅุดุนุงุฑุงุช ุงูุนููู
- โ ุชุฃููุฏ ุงูุทูุจ
- ๐ ุชุญุฏูุซ ุญุงูุฉ ุงูุดุญู
- โ ุฅูุบุงุก ุงูุทูุจ

## ุงูุฃูุงู

### ุงูุชุญูู ูู Webhooks
- ูุชู ุงูุชุญูู ูู ุชูููุน (signature) ูู webhook
- ูุณุชุฎุฏู Client Secret ูููุชุงุญ ุงูุชุดููุฑ
- ูุชู ุฑูุถ ุฃู webhook ุจุชูููุน ุบูุฑ ุตุญูุญ

### Tokens
- ูุชู ุญูุธ Access Token ูุดูุฑุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูุชู ุชุญุฏูุซ Token ุชููุงุฆูุงู ุนูุฏ ุงูุชูุงุก ุตูุงุญูุชู
- ูุง ูุชู ุนุฑุถ Tokens ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงูููุชุฌุงุช ูุง ุชุธูุฑ ูู WhatsApp
1. ุชุฃูุฏ ูู ูุฌุงุญ ุงููุฒุงููุฉ ูู **Zid > ุณุฌู ุงููุฒุงููุฉ**
2. ุชุญูู ูู ุฃู ุงูููุชุฌุงุช ููุดูุฑุฉ (isPublished = true)
3. ุชุญูู ูู ุฃู ุงูููุชุฌุงุช ูุดุทุฉ (isActive = true)

### Webhooks ูุง ุชุนูู
1. ุชุฃูุฏ ูู ุตุญุฉ Webhook URL ูู ููุญุฉ ุชุญูู Zid
2. ุชุญูู ูู ุณุฌู Webhooks ูู **Zid > Webhooks**
3. ุชุฃูุฏ ูู ุฅุฏุฎุงู Webhook Secret ุงูุตุญูุญ

### ุฎุทุฃ ูู ุงููุฒุงููุฉ
1. ุชุญูู ูู ุตูุงุญูุฉ Access Token
2. ุชุญูู ูู ุตูุงุญูุงุช API ูู Zid
3. ุฑุงุฌุน ุณุฌู ุงูุฃุฎุทุงุก ูู **Zid > ุณุฌู ุงููุฒุงููุฉ**

## ุงูุชุทููุฑ ุงููุณุชูุจูู

### ููุฒุงุช ููุชุฑุญุฉ:
- [ ] ุฅูุดุงุก ุทูุจุงุช ูู Zid ูู WhatsApp
- [ ] ุฅุฑุณุงู ุตูุฑ ุงูููุชุฌุงุช ูู WhatsApp
- [ ] ุฅุฑุณุงู ุฑุงุจุท ุงูููุชุฌ ูู ูุชุฌุฑ Zid
- [ ] ูุฒุงููุฉ ุงููุฎุฒูู ุซูุงุฆูุฉ ุงูุงุชุฌุงู
- [ ] ุชุชุจุน ุงูุดุญูุงุช ูู Zid
- [ ] ุชูุงุฑูุฑ ูุจูุนุงุช ููุญุฏุฉ

## ุงูุฏุนู ุงูููู

ูููุณุงุนุฏุฉ ุฃู ุงูุฅุจูุงุบ ุนู ูุดุงูู:
- ๐ง ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: support@sary.live
- ๐ฌ WhatsApp: [ุฑูู ุงูุฏุนู]
- ๐ ุงูุชูุซูู: https://docs.sary.live/zid-integration

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-05
**ุงูุฅุตุฏุงุฑ:** 1.0.0
